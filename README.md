# jenkinstesting

## What is this?
This is a jenkins file and startup scripts for a jenkins pipeline that does the following:
* Download the used environment and software (with couple of exceptions. See Requirements)
* Setup the environment so that Selenium testing can start
* Execute Selenium tests
* Record the traffic generated by the tests
* Get and parse a har-file generated by the proxy so that it only contains wanted traffic
* Turn har file to sequence file used in Defensics (currently not functional)
* Start Defensics testing based on the har

## Environment
### Test targets
* Mutillidae. Site hosted in docker container
* Swagger pet shop api. Api hosted in a docker container.

### Proxy
* Browsermob proxy. Used in recording the traffic generated by the Selenium tests
* Harparser. Software hosted in harparser repository. A java script that gets the har-file from browsermob and removes all traffic that doesn't come from or go to testing environment

### Tests
* Junit tests that utilize Selenium. Hosted in Seleniumtesting repository
* Synopsys Defensics.


## Requirements
Jenkinsfile will fetch the above components but it requires the following in order to work:

* java 8
* firefox
* firefox driver accessible from command line
* docker
* jenkins
* xvfb jenkins plugin
* Defensics
* ant
* git

Other:
* ports 8080 and 81 open. Petshop will be hosted in localhost:8080 and mutillidae at localhost:81/mutillidae
* Docker scripts are executed as sudo. You need to give docker the permissions to execute start/destroy docker scripts


## How to use this?
* Install jenkins
* Create a pipeline project
* Go to pipeline tab and change definition to "Pipeline script from SCM"
* Change SCM to Git and add this repos url to the Repository url field
* Save and Build

## TODO
* Our current iteration expects jenkins to have sudo permissions to bin/sh in docker scripts. Path should be changed to $JENKINS_WORKDIRECTORY$/enviroment/script_folder/script.sh




